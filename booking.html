<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <form onsubmit="savetolocalstorage(event)">
        <label >Name:</label>
        <input type="text" name ="username" id="usernameinputtag">
        <label >Email:</label>
        <input type="email" name ="emailId" id="emailinputtag" required>
        <label >phone Number:</label>
        <input type="tel" name ="phoneNumber" id="phoneNumberinputtag"required>
        <button>submit</button>
    </form>
    <ul id="listofitems"></ul>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
    <script>
        function savetolocalstorage(event){
            event.preventDefault();
            const name = event.target.username.value;
            const email = event.target.emailId.value;
            const phoneNumber = event.target.phoneNumber.value;
            // localStorage.setItem('name', name);
            // localStorage.setItem('email', email);
            // localStorage.setItem('phoneNumber', phoneNumber);
            const obj = {
                name,
                email,
                phoneNumber
            }

            axios.post("https://crudcrud.com/api/49ac5cbb515b4ca7a0c1fa0027bfa005/appointmentdataa", obj)
            .then((res)=>{
                showuseronscreen(res.data)
                console.log(res)
            })
            .catch((err) =>{
                document.body.innerHTML = document.body.innerHTML + "<h1> oops something is wrong</h1>"
                console.log(err)
            })
            // localStorage.setItem('userDetails',JSON.stringify(obj));
            // showuseronscreen(obj);

            // was to store the userdetails it in localstorage
            // show the user details on the screen using DOM manipulation


        }

        window.addEventListener("DOMContentLoaded",() => {
            const localstorageobj = localStorage;
            const localstoragekeys = Object.keys(localstorageobj)

            for(var i=0;i<localstoragekeys.length;i++){
                const key = localstoragekeys[i]
                const userdetailsstring = localstorageobj[key]
                const userdetailsobj = JSON.parse(userdetailsstring);
                shownewuseronscreen(userdetailsobj)
            }
        })

        function shownewuseronscreen(user){

        }
        function showuseronscreen(obj){
            const parentelement = document.getElementById('listofitems')
            const childelement = document.createElement('li')
            childelement.textContent = obj.name + ' - ' + obj.email + ' - ' + obj.phoneNumber
              

            // delete
            const deleteButton = document.createElement('input')
            deleteButton.type = "button"
            deleteButton.value = 'delete'
            deleteButton.onclick = () => {
                localStorage.removeItem(obj.email)
                parentelement.removeChild(childelement)
            }

            // edit
            const editButton = document.createElement('input')
            editButton.type = "button"
            editButton.value = 'edit'
            editButton.onclick = ()=>{
                localStorage.removeItem(obj.email)
                parentelement.removeChild(childelement)
                document.getElementById('usernameinputtag').value = obj.name
                document.getElementById('emailinputtag').value = obj.email
                document.getElementById('phoneNumberinputtag').value = obj.phoneNumber

            }

            childelement.appendChild(editButton)
            childelement.appendChild(deleteButton)
            parentelement.appendChild(childelement);
        }
    </script>
</body>
</html>
